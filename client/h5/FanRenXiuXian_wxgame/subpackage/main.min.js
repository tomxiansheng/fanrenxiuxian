var egret=window.egret,__reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function l(e){try{s(r["throw"](e))}catch(t){i(t)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,l)}s((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(r){n=[6,r],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,l,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l},AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function r(r){t.call(n,r,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?r(o):RES.getResAsync(e,r,this)}else RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return[4,this.loadResource()];case 1:return n.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=n.sent(),this.startAnimation(e),[4,platform.login()];case 3:return n.sent(),[4,platform.getUserInfo()];case 4:return t=n.sent(),console.log(t),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,this.loadTheme()];case 2:return n.sent(),[4,RES.loadGroup("preload",0,e)];case 3:return n.sent(),this.stage.removeChild(e),[3,5];case 4:return t=n.sent(),console.error(t),[3,5];case 5:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,n){var r=new eui.Theme("resource/default.thm.json",e.stage);r.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){var e=this.createBitmapByName("bg_jpg");this.addChild(e);var t=this.stage.stageWidth,n=this.stage.stageHeight;e.width=t,e.height=n;var r=new egret.Shape;r.graphics.beginFill(0,.5),r.graphics.drawRect(0,0,t,172),r.graphics.endFill(),r.y=33,this.addChild(r);var o=this.createBitmapByName("egret_icon_png");this.addChild(o),o.x=26,o.y=33;var i=new egret.Shape;i.graphics.lineStyle(2,16777215),i.graphics.moveTo(0,0),i.graphics.lineTo(0,117),i.graphics.endFill(),i.x=172,i.y=61,this.addChild(i);var a=new egret.TextField;a.textColor=16777215,a.width=t-172,a.textAlign="center",a.text="Hello Egret",a.size=24,a.x=172,a.y=80,this.addChild(a);var l=new egret.TextField;this.addChild(l),l.alpha=0,l.width=t-172,l.textAlign=egret.HorizontalAlign.CENTER,l.size=24,l.textColor=16777215,l.x=172,l.y=135,this.textfield=l;var s=new eui.Button;s.label="Click!",s.horizontalCenter=0,s.verticalCenter=0,this.addChild(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClick,this)},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,n=RES.getRes(e);return t.texture=n,t},t.prototype.startAnimation=function(e){var t=this,n=new egret.HtmlTextParser,r=e.map(function(e){return n.parse(e)}),o=this.textfield,i=-1,a=function(){i++,i>=r.length&&(i=0);var e=r[i];o.textFlow=e;var n=egret.Tween.get(o);n.to({alpha:1},200),n.wait(2e3),n.to({alpha:0},200),n.call(a,t)};a()},t.prototype.onButtonClick=function(e){var t=new eui.Panel;t.title="Title",t.horizontalCenter=0,t.verticalCenter=0,this.addChild(t)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,r){function o(e){t.call(r,e)}function i(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),n.call(r))}var a=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,n){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(r,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var l=e.split("/");l.pop();var s=l.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(r,generateJSON.paths[e])},this):RES.getResByUrl(s,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){t.call(r,generateJSON.paths[e])},a)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Handler=function(){function e(){}return e.prototype.addEvent=function(e,t,n){this._method=e,this._thisObj=t,this._args=n},e.prototype.execute=function(e){null==e&&this._method.apply(this._thisObj,this._args),this._method&&this._method.apply(this._thisObj,this._args?e.concat(this._args):e)},e.prototype.dispose=function(){this._method=null,this._args=null,this._thisObj=null},Object.defineProperty(e.prototype,"method",{get:function(){return this._method},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"args",{get:function(){return this._args},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thisObj",{get:function(){return this._thisObj},enumerable:!0,configurable:!0}),e}();__reflect(Handler.prototype,"Handler",["IDispose"]);var tool;!function(e){var t=function(){function t(){}return t.drawProgress=function(t,n,r,o,i,a,l,s){void 0===i&&(i=!1),void 0===a&&(a=0);for(var c=[],u=8;u<arguments.length;u++)c[u-8]=arguments[u];if(t&&t.parent){var h=t.parent.getChildByName("__drawProgress_shapeMask__");h||(h=e.Pool.getObject(egret.Shape),h.x=t.x+t.width/2,h.y=t.y+t.height/2,h.name="__drawProgress_shapeMask__",t.parent.addChild(h),t.mask=h);var p=a+n,g=a*Math.PI/180,f=function(){v>0&&(egret.clearInterval(v),v=0),h&&"__drawProgress_shapeMask__"==h.name&&(h.parent&&h.parent.removeChild(h),h.name=null,e.Pool.releaseObject(h))},d=function(){if(h.graphics.clear(),h.graphics.beginFill(65535,1),h.graphics.lineTo(0,o),i){var e=(a+360)%360;e=0==e?360:e,h.graphics.drawArc(0,0,o,p*Math.PI/180,e*Math.PI/180)}else h.graphics.drawArc(0,0,o,g,p*Math.PI/180);h.graphics.lineTo(0,0),h.graphics.endFill();var t=!0;s&&(t=c&&c.length>0?s.apply(l,[p,_].concat(c)):s.apply(l,[p,_])),p=(p+n)%360,_+=r,t||f()},v=0,_=r;return r>0?v=egret.setInterval(d,l,r):d(),f}},t.doBezierCurveMove=function(t,n,r,o,i,a,l,s){void 0===i&&(i=1e3),void 0===a&&(a=!1);for(var c=[],u=8;u<arguments.length;u++)c[u-8]=arguments[u];var h=function(){var e=!0;s&&c&&(e=s.apply(l,[]))},p=function(){};e.Pool.getObject;return egret.Tween.get(t,{loop:a,onChange:h}).to(null,i),p},t.setBtnModel1=function(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];if(e&&e.stage){var i=function(e){n&&(r?n.apply(t,[e].concat(r)):n.apply(t,[e]))},a=function(n){var r=e.stage;r.addEventListener(egret.TouchEvent.TOUCH_CANCEL,l,t),r.addEventListener(egret.TouchEvent.TOUCH_END,s,t),e.scaleY=.97*u,e.scaleX=.99*h,i("down")},l=function(n){var r=e.stage;r.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,l,t),r.removeEventListener(egret.TouchEvent.TOUCH_END,s,t),e.scaleY=u,e.scaleX=h,i("up")},s=function(n){var r=e.stage;r.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,l,t),r.removeEventListener(egret.TouchEvent.TOUCH_END,s,t),e.scaleY=u,e.scaleX=h,i("up")},c=function(){e.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,a,t);var n=e.stage;n.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,l,t),n.removeEventListener(egret.TouchEvent.TOUCH_END,s,t),e.scaleX=h,e.scaleY=u},u=e.scaleY,h=e.scaleX;c();var p=e.anchorOffsetX-e.width/2,g=e.anchorOffsetY-e.height;return e.x=e.x-p,e.y=e.y-g,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,a,t),c}},t.setBtnModel2=function(e,t,n,r,o,i){if(void 0===o&&(o=1e3),void 0===i&&(i=500),e&&e.stage){var a,l=function(n){var i=e.stage;i.addEventListener(egret.TouchEvent.TOUCH_CANCEL,u,t),i.addEventListener(egret.TouchEvent.TOUCH_END,h,t),p(),r&&(a=egret.setTimeout(s,t,o))},s=function(){p(),c(),a=egret.setInterval(c,t,i)},c=function(){r.execute([i])},u=function(r){var o=e.stage;o.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,u,t),o.removeEventListener(egret.TouchEvent.TOUCH_END,h,t),p(),n&&n.execute()},h=function(r){var o=e.stage;o.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,u,t),o.removeEventListener(egret.TouchEvent.TOUCH_END,h,t),p(),n&&n.execute()},p=function(){a>0&&(egret.clearTimeout(a),egret.clearInterval(a),a=0)},g=function(){p(),e.scaleX=d,e.scaleY=f,e.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,l,t);var n=e.stage;n.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,u,t),n.removeEventListener(egret.TouchEvent.TOUCH_END,h,t)},f=e.scaleY,d=e.scaleX,v=e.anchorOffsetX-e.width/2,_=e.anchorOffsetY-e.height;return e.x=e.x-v,e.y=e.y-_,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height,g(),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,l,t),g}},t.scrollTo=function(e,t,n,r,o,i){for(var a=[],l=6;l<arguments.length;l++)a[l-6]=arguments[l];if(e&&e.dataProvider&&!(r>=e.dataProvider.length)){var s,c,u,h=0,p=0;if(e.layout instanceof eui.VerticalLayout)c=e.layout.$typicalHeight+e.layout.gap,u=(e.dataProvider.length-1-r)*c,u>t?p=r*c:(p=e.dataProvider.length*c-t,p=0>p?0:p);else if(e.layout instanceof eui.HorizontalLayout)s=e.layout.$typicalWidth+e.layout.gap,u=(e.dataProvider.length-1-r)*s,u>n?h=r*s:(h=e.dataProvider.length*s-n,h=0>h?0:h);else if(e.layout instanceof eui.TileLayout){c=e.layout.$typicalHeight+e.layout.verticalGap,s=e.layout.$typicalWidth+e.layout.horizontalGap;var g=(e.layout.columnCount,e.layout.rowCount,void 0),f=void 0;"rows"==e.layout.orientation?(g=r%e.layout.columnCount,(e.layout.columnCount-g)*s>n?h=g*s:(h=e.layout.columnCount*s-n,h=0>h?0:h),f=Math.ceil(r/e.layout.columnCount),0==g&&(f+=1),(e.layout.rowCount-f+1)*c>=t?p=(f-1)*c:(p=e.layout.rowCount*c-t,p=0>p?0:p)):"columns"==e.layout.orientation&&(f=r%e.layout.rowCount,(e.layout.rowCount-f)*c>t?p=f*c:(p=e.layout.rowCount*c-t,p=0>p?0:p),g=Math.ceil(r/e.layout.rowCount),0==f&&(g+=1),(e.layout.columnCount-g+1)*s>=n?h=(g-1)*s:(h=e.layout.columnCount*s-n,h=0>h?0:h))}if(i){var d=void 0;d=a?i.apply(o,[h,p].concat(a)):i.apply(o,[h,p]),e.scrollH=d.scrollH,e.scrollV=d.scrollV}else e.scrollH=h,e.scrollV=p}},t}();e.DrawUtils=t,__reflect(t.prototype,"tool.DrawUtils");var n=function(){function e(e,t,n,r,o,i){void 0===o&&(o=1e3),void 0===i&&(i=!1),this._target=e,this._p0=t,this._p1=n,this._p2=r,this._delay=o,this._loop=i}return e.prototype.play=function(){this.factor=0,egret.Tween.get(this,{loop:this._loop}).to({factor:1},this._delay)},e.prototype.stop=function(){egret.Tween.removeTweens(this),this.dispose()},Object.defineProperty(e.prototype,"factor",{set:function(e){var t=this;t._target.x=(1-e)*(1-e)*t._p0.x+2*e*(1-e)*t._p1.x+e*e*t._p2.x,t._target.y=(1-e)*(1-e)*t._p0.y+2*e*(1-e)*t._p1.y+e*e*t._p2.y},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._target=null,this._p0=null,this._p1=null,this._p2=null},e}();e.ArcMotion=n,__reflect(n.prototype,"tool.ArcMotion",["IDispose"])}(tool||(tool={}));var tool;!function(e){var t=function(){function e(){}return e.quickSort=function(t,n){if(!(null==t||t.length<=1)){for(var r,o=t[0],i=1,a=0,l=t.length-1;l>a;)n(o,t[i])<0?(r=t[i],t[i]=t[l],t[l]=r,l--):(r=t[i],t[i]=t[a],t[a]=t[i],a++,i++);t[a]=o,e.quickSort(t.slice(0,a),n),e.quickSort(t.slice(a+1,t.length),n)}},e}();e.MathTool=t,__reflect(t.prototype,"tool.MathTool")}(tool||(tool={}));var tool;!function(e){var t=function(){function t(){}return t.shakePhone=function(t,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(n){var i=e.Pool.getObject(egret.DeviceOrientation),a=function(){i&&(i.removeEventListener(egret.Event.CHANGE,onorientationchange,t),i.stop())},l=function(e){var o=!0;o=r?n.apply(t,[e.beta,e.gamma,e.alpha].concat(r)):n.apply(t,[e.beta,e.gamma,e.alpha]),o||a()};return i.addEventListener(egret.Event.CHANGE,l,t),i.start(),a}},t}();e.PhoneUtils=t,__reflect(t.prototype,"tool.PhoneUtils")}(tool||(tool={}));var tool;!function(e){var t=function(){function e(){}return e.getKeyByObj=function(e){return e.__proto__.__class__},e.getKeyByCls=function(e){return e.prototype.__class__},e.getObject=function(t){var n,r=e.getKeyByCls(t),o=e.getPoolByKey(r);return n=o.length>0?o.pop():new t,n[e.POOL_FLAG]=!1,n},e.getObjectByKey=function(t){var n,r=e.getPoolByKey(t);if(r.length>0)n=r.pop();else{var o=egret.getDefinitionByName(t);n=new o}return n[e.POOL_FLAG]=!1,n},e.releaseObject=function(t){var n=e.getKeyByObj(t);e.releaseObjectByKey(n,t)},e.releaseObjectByKey=function(t,n){var r=e.getPoolByKey(t);n[e.POOL_FLAG]=!0,r.push(n)},e.disposePool=function(t){var n=e.getKeyByCls(t);e.disposePoolByKey(n)},e.disposePoolByKey=function(t){delete e._poolDic[t]},e.getPool=function(t){var n=e.getKeyByCls(t);return e.getPoolByKey(n)},e.getPoolByKey=function(t){return e._poolDic[t]||(e._poolDic[t]=[])},e.POOL_FLAG="__InPool",e._poolDic={},e}();e.Pool=t,__reflect(t.prototype,"tool.Pool")}(tool||(tool={})),window.Main=Main;